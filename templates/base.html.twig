<!DOCTYPE html>
{{ encore_entry_link_tags('app') }}
<html lang="en">
	<head>
		<title>
			{% block title %}Eventopia
			{% endblock %}
		</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		{% block stylesheets %}
			<!-- Google Fonts -->
			<link
			href="https://fonts.googleapis.com/css?family=Work+Sans:100,200,300,400,500,600,700,800,900" rel="stylesheet">
			<!-- Main CSS Files -->
			<link rel="stylesheet" href="{{ asset('css/bootstrap.min.css') }}">
			<link rel="stylesheet" href="{{ asset('css/open-iconic-bootstrap.min.css') }}">
			<link rel="stylesheet" href="{{ asset('css/animate.css') }}">
			<link rel="stylesheet" href="{{ asset('css/style.css') }}">
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">
			<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css"/>
			<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" integrity="sha512-5A8nwdMOWrSz20fDsjczgUidUBR8liPYU+WymTZP1lmY9G6Oc7HlZv156XqnsgNUzTyMefFTcsFH/tnJE/+xBg==" crossorigin="anonymous" referrerpolicy="no-referrer"/>
			<style>
				/* Chatbot Styles */
				.chatbot-container {
					position: fixed;
					bottom: 30px;
					right: 30px;
					z-index: 9999;
				}

				.chatbot-btn {
					width: 60px;
					height: 60px;
					border-radius: 50%;
					background: linear-gradient(135deg,rgb(21, 53, 157), #a777ee);
					color: white;
					border: none;
					cursor: pointer;
					box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
					display: flex;
					align-items: center;
					justify-content: center;
					transition: all 0.3s ease;
				}

				.chatbot-btn i {
					font-size: 24px;
				}

				.chatbot-window {
					width: 400px;
					height: 480px;
					background: white;
					border-radius: 15px;
					box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
					position: absolute;
					bottom: 80px;
					right: 0;
					display: none;
					flex-direction: column;
					overflow: hidden;
				}

				.chatbot-window.active {
					display: flex;
				}

				.chatbot-header {
					background: linear-gradient(135deg,rgb(21, 53, 157), #a777ee);
					color: white;
					padding: 15px;
					display: flex;
					align-items: center;
					justify-content: space-between;
				}

				.chatbot-header h3 {
					margin: 0;
					font-size: 18px;
				}

				.chatbot-close {
					background: none;
					border: none;
					color: white;
					font-size: 20px;
					cursor: pointer;
				}

				.chatbot-body {
					flex: 1;
					padding: 15px;
					overflow-y: auto;
					background-color: #f9f9f9;
				}

				.chatbot-message {
					margin-bottom: 15px;
					display: flex;
					flex-direction: column;
				}

				.bot-message .message-content {
					background: #e9ecef;
					color: #333;
					border-radius: 15px 15px 15px 0;
					align-self: flex-start;
					padding: 10px 15px;
					max-width: 80%;
				}

				.user-message .message-content {
					background: #6e8efb;
					color: white;
					border-radius: 15px 15px 0 15px;
					align-self: flex-end;
					padding: 10px 15px;
					max-width: 80%;
				}

				.message-time {
					font-size: 11px;
					color: #999;
					margin-top: 5px;
				}

				.user-message .message-time {
					text-align: right;
				}

				.chatbot-footer {
					padding: 15px;
					background: white;
					border-top: 1px solid #eee;
					display: flex;
				}

				.chatbot-input {
					flex: 1;
					border: 1px solid #ddd;
					border-radius: 30px;
					padding: 10px 15px;
					outline: none;
				}

				.chatbot-send {
					background: rgb(25, 58, 165);
					color: white;
					border: none;
					border-radius: 50%;
					width: 40px;
					height: 40px;
					margin-top: 5px;
					margin-left: 10px;
					cursor: pointer;
				}
			</style>

		{% endblock %}


	</head>

	<body>
		{% block navbar %}{% endblock %}

		{% block body %}{% endblock %}
		<!-- Add this to your base template (just before the closing </body> tag) -->
		<div class="chatbot-container">
			<div class="chatbot-window">
				<div class="chatbot-header">
					<h3>
						<b style="color:white">Eventopia Assistant</b>
					</h3>
					<button class="chatbot-close">
						<i class="fa fa-times"></i>
					</button>
				</div>
				<div class="chatbot-body"></div>
				<div class="chatbot-footer">
					<input type="text" class="chatbot-input" placeholder="Type your message...">
					<button class="chatbot-send">
						<i class="fa fa-paper-plane"></i>
					</button>
				</div>
			</div>
			<button class="chatbot-btn">
				<i class="fa fa-comments"></i>
			</button>
		</div>


		{% block footer %}{% endblock %}


		{% block javascripts %}
			<script src="{{ asset('js/jquery.min.js') }}"></script>
			<script src="{{ asset('js/bootstrap.min.js') }}"></script>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
			<script src="{{ asset('js/main.js') }}"></script>
			<script src="https://unpkg.com/aos@next/dist/aos.js"></script>
			<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
			<script>
				document.querySelector('.chatbot-btn').addEventListener('click', function () {
document.querySelector('.chatbot-window').classList.toggle('active');
});

document.querySelector('.chatbot-close').addEventListener('click', function () {
document.querySelector('.chatbot-window').classList.remove('active');
});

const chatbotInput = document.querySelector('.chatbot-input');
const chatbotBody = document.querySelector('.chatbot-body');
const sendButton = document.querySelector('.chatbot-send');

function appendMessage(message, sender = 'bot') {
const messageEl = document.createElement('div');
messageEl.className = `chatbot-message ${sender}-message`;
messageEl.innerHTML = `
            <div class="message-content">${message}</div>
            <div class="message-time">${
new Date().toLocaleTimeString([], {
hour: '2-digit',
minute: '2-digit'
})
}</div>
        `;
chatbotBody.appendChild(messageEl);
chatbotBody.scrollTop = chatbotBody.scrollHeight;
}

sendButton.addEventListener('click', () => {
const message = chatbotInput.value.trim();
if (message === '') 
return;



appendMessage(message, 'user');
chatbotInput.value = '';

fetch('/chatbot/message', {
method: 'POST',
headers: {
'Content-Type': 'application/json'
},
body: JSON.stringify({message})
}).then(response => response.json()).then(data => {
appendMessage(data.response, 'bot');
}).catch(() => {
appendMessage("Sorry, something went wrong.", 'bot');
});
});

chatbotInput.addEventListener('keypress', function (e) {
if (e.key === 'Enter') {
sendButton.click();
}
});
			</script>

			{% block extra_scripts %}{% endblock %}
		{% endblock %}
	</body>
</html>
